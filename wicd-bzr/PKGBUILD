# Contributor: Tuxce <tuxce.net@gmail.com>

pkgname=wicd-bzr
pkgver=461
pkgrel=1
pkgdesc="Wired and wireless network manager which aims to provide a simple interface to connect to networks with a wide variety of settings."
arch=('i686' 'x86_64')
url="http://wicd.sourceforge.net/"
license=('GPL')
depends=('dbus-python' 'pygtk' 'ethtool' 'wpa_supplicant')
optdepends=('python-urwid: wicd-curses')
makedepends=('bzr')
provides=('wicd')
conflicts=('wicd' 'wicd-svn')
replaces=('wicd' 'wicd-svn')
install=wicd.install
source=()
md5sums=()

_bzrtrunk=lp:wicd
_bzrmod=wicd

build() {
  cd ${srcdir}

  msg "Connecting to the server...."

  bzr branch ${_bzrtrunk} -q -r ${pkgver}

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  [ -d ./${_bzrmod}-build ] && rm -rf ./${_bzrmod}-build
  cp -r ./${_bzrmod} ./${_bzrmod}-build
  cd ./${_bzrmod}-build

  msg "Starting make..."

  install -d -m 755 $pkgdir/etc
  touch $pkgdir/etc/arch-release

  # Configure & install
  python setup.py configure || return 1
  #python setup.py get_translations
  python setup.py install --root ${startdir}/pkg/ || return 1


  # Add missing directories and delete useless one
  rm -r ${startdir}/pkg/usr/share/autostart
  rm $pkgdir/etc/arch-release

}
